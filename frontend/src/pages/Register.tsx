aW1wb3J0IHsgTG9ja091dGxpbmVkLCBNYWlsT3V0bGluZWQsIFVzZXJPdXRsaW5lZCB9IGZyb20gJ0BhbnQtZGVzaWduL2ljb25zJzsKaW1wb3J0IHsgQWxlcnQsIEJ1dHRvbiwgQ2FyZCwgRm9ybSwgSW5wdXQsIFR5cG9ncmFwaHkgfSBmcm9tICdhbnRkJzsKaW1wb3J0IHsgTGluaywgdXNlTmF2aWdhdGUgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJzsKaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi4vaG9va3MvdXNlQXV0aCc7Cgpjb25zdCB7IFRpdGxlLCBUZXh0IH0gPSBUeXBvZ3JhcGh5OwoKZXhwb3J0IGZ1bmN0aW9uIFJlZ2lzdGVyUGFnZSgpIHsKICBjb25zdCBuYXZpZ2F0ZSA9IHVzZU5hdmlnYXRlKCk7CiAgY29uc3QgeyB1c2VyLCBzdGF0dXMsIHJlZ2lzdGVyLCBlcnJvciwgaW5pdGlhbGl6ZSB9ID0gdXNlQXV0aCgpOwoKICB1c2VFZmZlY3QoKCkgPT4gewogICAgaWYgKHN0YXR1cyA9PT0gJ2lkbGUnKSB7CiAgICAgIHZvaWQgaW5pdGlhbGl6ZSgpOwogICAgfQogIH0sIFtzdGF0dXMsIGluaXRpYWxpemVdKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGlmICh1c2VyICYmIHN0YXR1cyA9PT0gJ2F1dGhlbnRpY2F0ZWQnKSB7CiAgICAgIG5hdmlnYXRlKCcvZGFzaGJvYXJkJywgeyByZXBsYWNlOiB0cnVlIH0pOwogICAgfQogIH0sIFt1c2VyLCBzdGF0dXMsIG5hdmlnYXRlXSk7CgogIGNvbnN0IG9uRmluaXNoID0gYXN5bmMgKHZhbHVlczogeyBlbWFpbDogc3RyaW5nOyBwYXNzd29yZDogc3RyaW5nOyBmdWxsX25hbWU/OiBzdHJpbmcgfSkgPT4gewogICAgY29uc3QgdXNlckluZm8gPSBhd2FpdCByZWdpc3Rlcih2YWx1ZXMuZW1haWwsIHZhbHVlcy5wYXNzd29yZCwgdmFsdWVzLmZ1bGxfbmFtZSk7CiAgICBpZiAodXNlckluZm8ucm9sZSA9PT0gJ2FkbWluJykgewogICAgICBuYXZpZ2F0ZSgnL2FkbWluJywgeyByZXBsYWNlOiB0cnVlIH0pOwogICAgfSBlbHNlIHsKICAgICAgbmF2aWdhdGUoJy9kYXNoYm9hcmQnLCB7IHJlcGxhY2U6IHRydWUgfSk7CiAgICB9CiAgfTsKCiAgcmV0dXJuICgKICAgIDxkaXYgc3R5bGU9e3sgZGlzcGxheTogJ2ZsZXgnLCBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBtaW5IZWlnaHQ6ICcxMDB2aCcgfX0+CiAgICAgIDxDYXJkIHN0eWxlPXt7IHdpZHRoOiAzODAgfX0gYm9yZGVyZWQ9e2ZhbHNlfT4KICAgICAgICA8VGl0bGUgbGV2ZWw9ezN9IHN0eWxlPXt7IHRleHRBbGlnbjogJ2NlbnRlcicgfX0+CiAgICAgICAgICDms6jlhowgQ2xhdWRlQ29kZSDotKblj7cKICAgICAgICA8L1RpdGxlPgogICAgICAgIDxGb3JtIGxheW91dD0idmVydGljYWwiIG9uRmluaXNoPXtvbkZpbmlzaH0+CiAgICAgICAgICA8Rm9ybS5JdGVtIG5hbWU9ImZ1bGxfbmFtZSIgbGFiZWw9IuWnk+WQjSI+CiAgICAgICAgICAgIDxJbnB1dCBwcmVmaXg9ezxVc2VyT3V0bGluZWQgLz59IHBsYWNlaG9sZGVyPSLmgqjnmoTlp5PlkI0iIGFsbG93Q2xlYXIgLz4KICAgICAgICAgIDwvRm9ybS5JdGVtPgogICAgICAgICAgPEZvcm0uSXRlbSBuYW1lPSJlbWFpbCIgbGFiZWw9IumCrueusSIgcnVsZXM9e1t7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6YKu566xJyB9LCB7IHR5cGU6ICdlbWFpbCcsIG1lc3NhZ2U6ICfpgq7nrrHmoLzlvI/kuI3mraPnoa4nIH1dfT4KICAgICAgICAgICAgPElucHV0IHByZWZpeD17PE1haWxPdXRsaW5lZCAvPn0gcGxhY2Vob2xkZXI9InlvdUBleGFtcGxlLmNvbSIgYXV0b0NvbXBsZXRlPSJlbWFpbCIgYWxsb3dDbGVhciAvPgogICAgICAgICAgPC9Gb3JtLkl0ZW0+CiAgICAgICAgICA8Rm9ybS5JdGVtIG5hbWU9InBhc3N3b3JkIiBsYWJlbD0i5a+G56CBIiBydWxlcz17W3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXlr4bnoIEnIH0sIHsgbWluOiA4LCBtZXNzYWdlOiAn6Iez5bCRIDgg5L2NJyB9XX0+CiAgICAgICAgICAgIDxJbnB1dC5QYXNzd29yZCBwcmVmaXg9ezxMb2NrT3V0bGluZWQgLz59IHBsYWNlaG9sZGVyPSLlr4bnoIEiIGF1dG9Db21wbGV0ZT0ibmV3LXBhc3N3b3JkIiAvPgogICAgICAgICAgPC9Gb3JtLkl0ZW0+CiAgICAgICAgICB7ZXJyb3IgJiYgKAogICAgICAgICAgICA8QWxlcnQgdHlwZT0iZXJyb3IiIG1lc3NhZ2U9e2Vycm9yfSBzaG93SWNvbiBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDE2IH19IC8+CiAgICAgICAgICApfQogICAgICAgICAgPEJ1dHRvbiB0eXBlPSJwcmltYXJ5IiBodG1sVHlwZT0ic3VibWl0IiBibG9jayBsb2FkaW5nPXtzdGF0dXMgPT09ICdsb2FkaW5nJ30+CiAgICAgICAgICAgIOazqOWGjOWHFuWvuei/mwogICAgICAgICAgPC9CdXR0b24+CiAgICAgICAgPC9Gb3JtPgogICAgICAgIDxkaXYgc3R5bGU9e3sgbWFyZ2luVG9wOiAxNiwgdGV4dEFsaWduOiAnY2VudGVyJyB9fT4KICAgICAgICAgIDxUZXh0PgogICAgICAgICAgICDku6Xmm7/lho3ku6Plk4Hkvb/nlKg/IDxMaW5rIHRvPSIvbG9naW4iPuadpeilvzwvTGluaz4KICAgICAgICAgIDwvVGV4dD4KICAgICAgICA8L2Rpdj4KICAgICAgPC9DYXJkPgogICAgPC9kaXY+CiAgKTsKfQo=